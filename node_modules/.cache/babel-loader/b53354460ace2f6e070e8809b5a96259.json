{"ast":null,"code":"var _jsxFileName = \"/Users/yan/Coding/flattenthecurve/src/components/MainVizComponent/MainVizComponent.js\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport styles from './MainVizComponent.scss';\nimport _ from 'lodash';\nimport { select, selectAll } from 'd3-selection';\nimport { scaleBand, scaleLinear, scaleQuantile, scaleSequential } from 'd3-scale';\nimport { interpolateReds } from 'd3-scale-chromatic';\nimport { axisBottom, axisLeft, axisRight } from 'd3-axis';\nimport { format } from 'd3-format';\nimport { default as tip } from 'd3-tip';\nimport { min, max } from 'd3-array';\nimport { timeMonth } from 'd3-time';\nimport { makeTooltip } from '../../VizHelpers';\nimport { downloadable } from 'd3-downloadable';\nimport { timeFormat, timeParse } from 'd3-time-format';\nimport * as moment from 'moment';\n\nclass MainVizComponent extends Component {\n  constructor(props) {\n    super(props);\n\n    this.setHeightFromDateExtant = (minDate, maxDate) => this.setHeight(maxDate.diff(minDate, 'months'));\n\n    this.setHeight = length => length * 180 + 500;\n\n    this.createChart = this.createChart.bind(this);\n    this.state = {\n      height: 4000\n    };\n  }\n\n  componentDidMount() {\n    console.log(this.props);\n    this.setState({\n      height: this.props.timeline ? this.setHeightFromDateExtant(this.props.minDate, this.props.maxDate) : this.setHeight(this.props.data.length),\n      months: this.props.timeline ? this.props.maxDate.diff(this.props.minDate, 'months') : 0\n    });\n    this.createChart();\n  }\n\n  componentDidUpdate() {\n    this.createChart();\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.data !== this.props.data || nextProps.timeline !== this.props.timeline) {\n      this.setState({\n        height: nextProps.timeline ? this.setHeightFromDateExtant(nextProps.minDate, nextProps.maxDate) : this.setHeight(nextProps.data.length),\n        months: nextProps.timeline ? nextProps.maxDate.diff(nextProps.minDate, 'months') : 0\n      });\n    }\n  }\n\n  createChart() {\n    let data = this.props.data ? this.props.data : []; // let timeline = this.props.timeline;\n\n    let {\n      revAsCircles,\n      timeline\n    } = this.props;\n    var margin = {\n      top: 150,\n      right: 5,\n      bottom: 5,\n      left: this.props.width / 3\n    },\n        width = this.props.width - margin.left - margin.right,\n        height = this.state.height - margin.top - margin.bottom,\n        node = select(this.node);\n    console.log(data);\n    console.log(revAsCircles);\n    data = _.sortBy(data, \"Date_of_sale\"); // const barHeight = 5;\n\n    data.forEach(d => {\n      d.yRevBottom = 0;\n      d.yRevTop = 0;\n    }); // var durationFormat = format(\".1f\");\n\n    var numFormat = format(',.2f');\n    var yTimeLine = scaleLinear().range([height, 0]);\n    var yIndex = scaleLinear().range([height, 0]);\n    var config = {\n      xOffset: 0,\n      yOffset: 0,\n      // width: 150,\n      width: width / 8,\n      height: height,\n      labelPositioning: {\n        alpha: 0.5,\n        spacing: 18\n      },\n      leftTitle: \"Lifting\",\n      rightTitle1: \"Buyer\",\n      rightTitle2: \"& Destination\",\n      leftSubTitle: \"Date of Sale\",\n      rightSubTitle: \"Payment Due Date\",\n      labelGroupOffset: 5,\n      labelKeyOffset: 50,\n      radius: 6,\n      subTitleYShift: 20,\n      // Reduce this to turn on detail-on-hover version\n      unfocusOpacity: 0.3,\n      revWidthMultiple: 3.5,\n      priceWidthMultiple: 1.5,\n      timelineWidthMultiple: 0.6\n    };\n    var smallConfig = {\n      maxwidth: width / 15 > 20 ? width / 15 : 20,\n      height: 10,\n      // color: '#c59800',\n      color: '#ecb600',\n      highlightColor: '#CE1126',\n      border: '#eee',\n      volWidth: 2.5,\n      revBoxesPerCol: 10,\n      maxRevWidth: 400,\n      volTitle: \"Volume (barrels)\",\n      priceTitle1: \"Price\",\n      priceTitle2: \"(US$)\",\n      revTitle1: \"Revenue\",\n      revTitle2: \"(US$)\"\n    };\n    let tooltip = tip().attr('class', 'd3-tip').offset([0, 20]).direction(d => revAsCircles ? 'e' : 'se').html(d => {\n      return makeTooltip(d.year, [{\n        label: \"Lifting\",\n        value: d.Lifting\n      }, {\n        label: \"Date of Sale\",\n        value: d.Date_of_sale.format(\"D MMM YYYY\")\n      }, {\n        label: \"Payment Receipt Date\",\n        value: d.Payment_receipt_date.format(\"D MMM YYYY\")\n      }, {\n        label: \"Price\",\n        value: \"US$ \" + numFormat(d.Price) + \" per barrel\"\n      }, {\n        label: \"Volume\",\n        value: numFormat(d.Volume) + \" barrels\"\n      }, {\n        label: \"Revenue\",\n        value: \"US$ \" + numFormat(d.Revenue)\n      }, {\n        label: \"Buyer\",\n        value: d.Buyer\n      }, {\n        label: \"Destination\",\n        value: d.Destination\n      }]);\n    });\n    node.selectAll(\"g\").remove();\n    var colorScale = scaleSequential(interpolateReds).domain([0, 10]);\n    var parse = timeParse(\"%s\"); // gridlines in y axis function\n\n    function make_y_gridlines(months, minDate, maxDate) {\n      console.log(minDate, maxDate);\n      console.log(timeMonth.range(minDate, maxDate).map(d => +d));\n      return axisLeft(yTimeLine).tickValues(timeMonth.range(minDate, maxDate).map(d => +d)); // .tickValues([1420041600000,1500000000000,1519833600000])\n    } // \tvar getColor = function(cpue) {\n    // \t\tif (cpue) {\n    // \t\t\treturn colorScale(cpue);\n    // \t\t} else return \"#ccc\";\n    // }\n\n\n    var getY = function (yVal, index) {\n      if (timeline) {\n        return yTimeLine(yVal);\n      } else {\n        return yIndex(index);\n      }\n    }; // Calculate y domain for ratios\n\n\n    var maxDate = moment(moment.max(data.map(d => d.Payment_receipt_date)).toDate());\n    var minDate = moment(moment.min(data.map(d => d.Date_of_sale)).toDate());\n    yTimeLine.domain([timeMonth.floor(maxDate.add(2, 'months')), timeMonth.floor(minDate.subtract(1, 'months'))]);\n    yIndex.domain([data.length, -1]);\n    console.log(yTimeLine.domain());\n    console.log(timeMonth.range(timeMonth.floor(yTimeLine.domain()[0]), timeMonth.ceil(yTimeLine.domain()[1])));\n\n    if (timeline) {\n      // add the Y gridlines\n      node.append(\"g\").attr(\"class\", \"grid\").attr(\"transform\", \"translate(0,\" + margin.top + \")\").call(make_y_gridlines(this.state.months, yTimeLine.domain()[1], yTimeLine.domain()[0]).tickSize(-width * 2).tickFormat(function (d) {\n        return timeFormat(\"%b %Y\")(d);\n      }));\n    }\n\n    node.selectAll('.grid text').attr(\"dy\", 20).attr(\"dx\", 10);\n    var borderLines = node.append(\"g\").attr(\"class\", \"borderLines\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    borderLines.append(\"line\").attr(\"x1\", 0).attr(\"y1\", 0).attr(\"x2\", 0).attr(\"y2\", config.height);\n    borderLines.append(\"line\").attr(\"x1\", config.width * config.timelineWidthMultiple).attr(\"y1\", 0).attr(\"x2\", config.width * config.timelineWidthMultiple).attr(\"y2\", config.height);\n    var slopeGroups = node.append(\"g\").selectAll(\"g\").data(data).enter().append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\").attr(\"class\", \"slope-group\").attr(\"id\", function (d, i) {\n      d.id = \"group\" + d.Lifting;\n      d.sellDate = d.Date_of_sale.toDate();\n      d.paymentDate = d.Payment_receipt_date.toDate();\n    });\n    var slopeLines = slopeGroups.append(\"line\").attr(\"class\", \"slope-line\").attr(\"x1\", 0).attr(\"y1\", function (d, i) {\n      return getY(d.sellDate, i);\n    }).attr(\"x2\", config.width * config.timelineWidthMultiple).attr(\"y2\", function (d, i) {\n      return getY(d.paymentDate, i);\n    });\n    var leftSlopeCircle = slopeGroups.append(\"circle\").attr(\"class\", function (d) {\n      return \"circle\";\n    }).attr(\"r\", config.radius).attr(\"cy\", function (d, i) {\n      return getY(d.sellDate, i);\n    });\n    var leftSlopeLabels = slopeGroups.append(\"g\").attr(\"class\", \"slope-label-left\").each(function (d, i) {\n      d.xLeftPosition = -config.labelGroupOffset;\n      d.yLeftPosition = getY(d.sellDate, i);\n    });\n    leftSlopeLabels.append(\"text\").attr(\"class\", \"label-figure-small\").attr(\"x\", d => d.xLeftPosition).attr(\"y\", d => d.yLeftPosition).attr(\"dx\", -10).attr(\"dy\", config.subTitleYShift).attr(\"text-anchor\", \"end\").text(d => d.Date_of_sale.format(\"D MMM YYYY\"));\n    leftSlopeLabels.append(\"text\").attr(\"class\", \"label-figure\").attr(\"x\", d => d.xLeftPosition).attr(\"y\", d => d.yLeftPosition).attr(\"dx\", -10).attr(\"dy\", 3).attr(\"text-anchor\", \"end\").text(d => d.Lifting);\n    var rightSlopeCircle = slopeGroups.append(\"circle\").attr(\"class\", function (d) {\n      return \"circle\";\n    }).attr(\"r\", config.radius).attr(\"cx\", config.width * config.timelineWidthMultiple).attr(\"cy\", function (d, i) {\n      return getY(d.paymentDate, i);\n    });\n    var rightSlopeLabels = slopeGroups.append(\"g\").attr(\"class\", \"slope-label-right\").each(function (d, i) {\n      d.xRightPosition = config.width * config.timelineWidthMultiple + config.labelGroupOffset;\n      d.yRightPosition = getY(d.paymentDate, i);\n    });\n    rightSlopeLabels.append(\"text\").attr(\"class\", \"label-figure-small\").attr(\"x\", d => d.xRightPosition).attr(\"y\", d => d.yRightPosition).attr(\"dx\", 10).attr(\"dy\", 2 * config.subTitleYShift).attr(\"text-anchor\", \"start\").text(d => d.Payment_receipt_date.format(\"D MMM YYYY\"));\n    rightSlopeLabels.append(\"text\").attr(\"class\", \"label-figure\").attr(\"x\", d => d.xRightPosition).attr(\"y\", d => d.yRightPosition).attr(\"dx\", 10).attr(\"dy\", 3).attr(\"text-anchor\", \"start\").text(d => d.Buyer);\n    rightSlopeLabels.append(\"text\").attr(\"class\", \"label-figure\").attr(\"x\", d => d.xRightPosition).attr(\"y\", d => d.yRightPosition).attr(\"dx\", 10).attr(\"dy\", 3 + config.subTitleYShift).attr(\"text-anchor\", \"start\").text(d => d.Destination);\n    var titles = node.append(\"g\").attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\").attr(\"class\", \"title\");\n    titles.append(\"text\").attr(\"text-anchor\", \"end\").attr(\"x\", margin.left).attr(\"dx\", -10).attr(\"dy\", -margin.top / 4).text(config.leftTitle);\n    titles.append(\"text\").attr(\"text-anchor\", \"end\").attr(\"class\", \"label-figure-small\").attr(\"x\", margin.left).attr(\"dx\", -10).attr(\"dy\", -margin.top / 4 + config.subTitleYShift).text(config.leftSubTitle);\n    titles.append(\"text\").attr(\"x\", margin.left + config.width * config.timelineWidthMultiple).attr(\"dx\", 10).attr(\"dy\", -margin.top / 4).text(config.rightTitle1);\n    titles.append(\"text\").attr(\"x\", margin.left + config.width * config.timelineWidthMultiple).attr(\"dx\", 10).attr(\"dy\", -margin.top / 4 + config.subTitleYShift).text(config.rightTitle2);\n    titles.append(\"text\").attr(\"class\", \"label-figure-small\").attr(\"x\", margin.left + config.width * config.timelineWidthMultiple).attr(\"dx\", 10).attr(\"dy\", -margin.top / 4 + 2 * config.subTitleYShift).text(config.rightSubTitle);\n    var priceBars = node.append(\"g\").attr(\"transform\", \"translate(\" + (margin.left + config.width) + \",\" + margin.top + \")\").attr(\"class\", \"price\");\n    var smallX = scaleLinear().range([0, smallConfig.maxwidth]).domain([0, 100]);\n    var maxRev = max(data.map(d => d.Revenue));\n    var circleX = scaleLinear().range([0, config.width]).domain([0, Math.sqrt(maxRev)]);\n\n    function makeClass(d) {\n      return d.Lifting.split(\" \").join(\"\").toLowerCase();\n    }\n\n    var volBars = [];\n    var revBars = [];\n    var annotations = [];\n    priceBars.selectAll(\".bar\").data(data).enter().append(\"rect\").attr(\"class\", function (d) {\n      return \"bar price \" + makeClass(d);\n    }).attr(\"x\", function (d) {\n      return config.width * config.priceWidthMultiple;\n    }).attr(\"width\", function (d) {\n      return smallX(+d.Price);\n    }).attr(\"y\", function (d, i) {\n      return d.yRightPosition - smallConfig.height / 2;\n    }).attr(\"fill\", function (d) {\n      return smallConfig.color;\n    }).attr(\"stroke\", function (d) {\n      return smallConfig.border;\n    }).attr(\"height\", function (d) {\n      return smallConfig.height;\n    }).on('mouseover', function (d) {\n      tooltip.show(d, this);\n      selectAll(\".\" + makeClass(d)).attr(\"fill\", smallConfig.highlightColor);\n      selectAll(\".annote.\" + makeClass(d)).attr(\"display\", \"block\");\n    }).on('mouseout', function (d) {\n      tooltip.hide();\n      selectAll(\".\" + makeClass(d)).attr(\"fill\", smallConfig.color);\n      selectAll(\".annote.\" + makeClass(d)).attr(\"display\", \"none\");\n    });\n\n    if (revAsCircles) {\n      revBars.push(node.append(\"g\").attr(\"transform\", \"translate(\" + (margin.left + config.width * config.revWidthMultiple) + \",\" + margin.top + \")\").attr(\"class\", function (d) {\n        return \"rev\";\n      }));\n      revBars[0].selectAll(\".bar\").data(data).enter().append(\"circle\").attr(\"class\", function (d) {\n        return \"bar rev \" + makeClass(d);\n      }).attr(\"cx\", function (d) {\n        return config.width;\n      }).attr(\"r\", function (d) {\n        return circleX(Math.sqrt(+d.Revenue));\n      }).attr(\"cy\", function (d) {\n        var returnVal = d.yRightPosition;\n        return returnVal;\n      }).attr(\"fill\", function (d) {\n        return smallConfig.color;\n      }).attr(\"stroke\", function (d) {\n        return smallConfig.border;\n      }) // .attr(\"height\", function(d) { return smallConfig.height; })\n      .on('mouseover', function (d) {\n        tooltip.show(d, this);\n        selectAll(\".\" + makeClass(d)).attr(\"fill\", smallConfig.highlightColor);\n        selectAll(\".annote.\" + makeClass(d)).attr(\"display\", \"block\");\n      }).on('mouseout', function (d) {\n        tooltip.hide();\n        selectAll(\".\" + makeClass(d)).attr(\"fill\", smallConfig.color);\n        selectAll(\".annote.\" + makeClass(d)).attr(\"display\", \"none\");\n      });\n    }\n\n    titles.append(\"text\").attr(\"text-anchor\", \"start\").attr(\"x\", margin.left + config.width * (config.priceWidthMultiple + 1)).attr(\"dx\", -10).attr(\"dy\", -margin.top / 4).text(smallConfig.priceTitle1);\n    titles.append(\"text\").attr(\"text-anchor\", \"start\").attr(\"x\", margin.left + config.width * (config.priceWidthMultiple + 1)).attr(\"dx\", -10).attr(\"dy\", -margin.top / 4 + config.subTitleYShift).text(smallConfig.priceTitle2);\n    titles.append(\"text\").attr(\"text-anchor\", \"start\").attr(\"x\", 0).attr(\"dx\", 0).attr(\"dy\", -margin.top / 4).text(smallConfig.volTitle);\n    titles.append(\"text\").attr(\"text-anchor\", \"start\").attr(\"x\", margin.left + config.width * config.revWidthMultiple).attr(\"dx\", 0).attr(\"dy\", -margin.top / 4).text(smallConfig.revTitle1);\n    titles.append(\"text\").attr(\"x\", margin.left + config.width * config.revWidthMultiple).attr(\"dx\", 0).attr(\"dy\", -margin.top / 4 + config.subTitleYShift).text(smallConfig.revTitle2);\n    var volData = data.map(function (d) {\n      return _.range(0, Math.round(d.Volume / 10000));\n    }); // console.log(volData);\n\n    data.forEach(function (currentBatch, i) {\n      volBars.push(node.append(\"g\").attr(\"transform\", \"translate(\" + 10 + \",\" + margin.top + \")\").attr(\"class\", function (d) {\n        return \"volume\";\n      }));\n      revBars.push(node.append(\"g\").attr(\"transform\", \"translate(\" + (margin.left + config.width * config.revWidthMultiple) + \",\" + margin.top + \")\").attr(\"class\", function (d) {\n        return \"rev\";\n      })); // console.log(volBars);\n\n      volBars[i].selectAll(\".bar\").data(volData[i]).enter().append(\"rect\").attr(\"class\", function (d) {\n        return \"bar vol \" + makeClass(currentBatch);\n      }).attr(\"x\", function (d, j) {\n        return smallConfig.volWidth * j;\n      }).attr(\"width\", function (d) {\n        return smallConfig.volWidth;\n      }).attr(\"y\", function (d, j) {\n        return currentBatch.yLeftPosition - smallConfig.height / 2;\n      }).attr(\"fill\", function (d) {\n        return smallConfig.color;\n      }).attr(\"stroke\", function (d) {\n        return smallConfig.border;\n      }).attr(\"height\", function (d) {\n        return smallConfig.height;\n      }).on('mouseover', function (d) {\n        tooltip.show(currentBatch, this);\n        selectAll(\".\" + makeClass(currentBatch)).attr(\"fill\", smallConfig.highlightColor);\n        selectAll(\".annote.\" + makeClass(currentBatch)).attr(\"display\", \"block\");\n      }).on('mouseout', function (d) {\n        tooltip.hide();\n        selectAll(\".\" + makeClass(currentBatch)).attr(\"fill\", smallConfig.color);\n        selectAll(\".annote.\" + makeClass(currentBatch)).attr(\"display\", \"none\");\n      });\n\n      if (!revAsCircles) {\n        revBars[i].selectAll(\".bar\").data(volData[i]).enter().append(\"rect\").attr(\"class\", function (d) {\n          return \"bar rev \" + makeClass(currentBatch);\n        }).attr(\"x\", function (d, j) {\n          var boxWidth = smallX(+currentBatch.Price); // var boxesPerRow = Math.floor(smallConfig.maxRevWidth/boxWidth);\n\n          var index = Math.floor(j / smallConfig.revBoxesPerCol);\n          return index * boxWidth;\n        }).attr(\"width\", function (d) {\n          return smallX(+currentBatch.Price);\n        }).attr(\"y\", function (d, j) {\n          // var boxWidth = smallX(+currentBatch.Price)\n          // var boxesPerRow = Math.floor(smallConfig.maxRevWidth/boxWidth);\n          // var row = Math.floor(j/boxesPerRow);\n          // data[i].yRevBottom = data[i].yRevBottom > returnVal + smallConfig.height \n          // \t? data[i].yRevBottom\n          // \t: returnVal + smallConfig.height;\n          var index = j % smallConfig.revBoxesPerCol;\n          var returnVal = currentBatch.yRightPosition - smallConfig.height / 2 + smallConfig.height * index;\n          data[i].yRevBottom = data[i].yRevBottom > returnVal + smallConfig.height ? data[i].yRevBottom : returnVal + smallConfig.height;\n          return returnVal;\n        }).attr(\"fill\", function (d) {\n          return smallConfig.color;\n        }).attr(\"stroke\", function (d) {\n          return smallConfig.border;\n        }).attr(\"height\", function (d) {\n          return smallConfig.height;\n        }).on('mouseover', function (d) {\n          tooltip.show(currentBatch, this);\n          selectAll(\".\" + makeClass(currentBatch)).attr(\"fill\", smallConfig.highlightColor);\n          selectAll(\".annote.\" + makeClass(currentBatch)).attr(\"display\", \"block\");\n        }).on('mouseout', function (d) {\n          tooltip.hide();\n          selectAll(\".\" + makeClass(currentBatch)).attr(\"fill\", smallConfig.color);\n          selectAll(\".annote.\" + makeClass(currentBatch)).attr(\"display\", \"none\");\n        });\n      } // Volume Annotation\n\n\n      node.append(\"g\").attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\").append(\"text\").attr(\"text-anchor\", \"left\").attr(\"class\", function (d) {\n        return \"annote vol \" + makeClass(currentBatch);\n      }).attr(\"x\", 10).attr(\"dx\", 0).attr(\"y\", currentBatch.yLeftPosition - 10).attr(\"fill\", smallConfig.color).attr(\"display\", \"none\").text(numFormat(currentBatch.Volume) + \" barrels\"); // Price Annotation\n\n      node.append(\"g\").attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\").append(\"text\").attr(\"text-anchor\", \"middle\").attr(\"class\", function (d) {\n        return \"annote price \" + makeClass(currentBatch);\n      }).attr(\"x\", margin.left + config.width * (config.priceWidthMultiple + 1.25)).attr(\"dx\", 0).attr(\"y\", currentBatch.yRightPosition).attr(\"dy\", -10).attr(\"fill\", smallConfig.color).attr(\"display\", \"none\").text(\"US$ \" + numFormat(currentBatch.Price) + \" per barrel\"); // Revenue Annotation\n\n      node.append(\"g\").attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\").append(\"text\").attr(\"text-anchor\", \"left\").attr(\"class\", function (d) {\n        return \"annote rev \" + makeClass(currentBatch);\n      }).attr(\"x\", function () {\n        var defaultX = margin.left + config.width * (config.revWidthMultiple + .5);\n        return revAsCircles ? defaultX - config.width : defaultX;\n      }).attr(\"dx\", 0) // .attr(\"y\", currentBatch.yRightPosition - 10)\n      .attr(\"y\", function (d) {\n        data[i].yRevTop = currentBatch.yRightPosition - 30;\n        var defaultY = currentBatch.yRightPosition - 10;\n        return revAsCircles ? defaultY - config.width : defaultY;\n      }).attr(\"fill\", smallConfig.color).attr(\"display\", \"none\").text(\"US$ \" + numFormat(currentBatch.Revenue) + \" in revenue \"); // + numFormat(data[i].yRevTop) + \" \" + numFormat(data[i].yRevBottom) )\n    });\n    console.log(data); // Adjust Rev Blocks so they don't overlap\n    // Start from the bottom and keep pushing all the ones at the top up a bit untill\n    // they no longer overlap\n\n    var vCumulativeDelta = 0;\n\n    for (var j = data.length - 1; j > 0; j--) {\n      for (var i = data.length - 1; i > 0; i--) {\n        vCumulativeDelta = data[i - 1].yRevBottom > data[i].yRevTop ? data[i - 1].yRevBottom - data[i].yRevTop : 0;\n\n        if (vCumulativeDelta > 0) {\n          selectAll(\".rev.\" + makeClass(data[i - 1])).attr(\"transform\", \"translate(\" + 0 + \",\" + -vCumulativeDelta + \")\");\n          data[i - 1].yRevBottom -= vCumulativeDelta;\n          data[i - 1].yRevTop -= vCumulativeDelta;\n          break;\n        }\n      }\n    }\n\n    node.call(tooltip);\n    select('.MainChart').call(downloadable());\n  }\n\n  render() {\n    // let data = this.props.data ? this.props.data : [];\n    return React.createElement(\"div\", {\n      className: \"MainVizComponent\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 658\n      },\n      __self: this\n    }, React.createElement(\"svg\", {\n      className: \"MainChart\",\n      ref: node => this.node = node,\n      width: this.props.width,\n      height: this.state.height,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 659\n      },\n      __self: this\n    }));\n  }\n\n}\n\nMainVizComponent.propTypes = {};\nMainVizComponent.defaultProps = {};\nexport default MainVizComponent;","map":{"version":3,"sources":["/Users/yan/Coding/flattenthecurve/src/components/MainVizComponent/MainVizComponent.js"],"names":["React","Component","PropTypes","styles","_","select","selectAll","scaleBand","scaleLinear","scaleQuantile","scaleSequential","interpolateReds","axisBottom","axisLeft","axisRight","format","default","tip","min","max","timeMonth","makeTooltip","downloadable","timeFormat","timeParse","moment","MainVizComponent","constructor","props","setHeightFromDateExtant","minDate","maxDate","setHeight","diff","length","createChart","bind","state","height","componentDidMount","console","log","setState","timeline","data","months","componentDidUpdate","componentWillReceiveProps","nextProps","revAsCircles","margin","top","right","bottom","left","width","node","sortBy","forEach","d","yRevBottom","yRevTop","numFormat","yTimeLine","range","yIndex","config","xOffset","yOffset","labelPositioning","alpha","spacing","leftTitle","rightTitle1","rightTitle2","leftSubTitle","rightSubTitle","labelGroupOffset","labelKeyOffset","radius","subTitleYShift","unfocusOpacity","revWidthMultiple","priceWidthMultiple","timelineWidthMultiple","smallConfig","maxwidth","color","highlightColor","border","volWidth","revBoxesPerCol","maxRevWidth","volTitle","priceTitle1","priceTitle2","revTitle1","revTitle2","tooltip","attr","offset","direction","html","year","label","value","Lifting","Date_of_sale","Payment_receipt_date","Price","Volume","Revenue","Buyer","Destination","remove","colorScale","domain","parse","make_y_gridlines","map","tickValues","getY","yVal","index","toDate","floor","add","subtract","ceil","append","call","tickSize","tickFormat","borderLines","slopeGroups","enter","i","id","sellDate","paymentDate","slopeLines","leftSlopeCircle","leftSlopeLabels","each","xLeftPosition","yLeftPosition","text","rightSlopeCircle","rightSlopeLabels","xRightPosition","yRightPosition","titles","priceBars","smallX","maxRev","circleX","Math","sqrt","makeClass","split","join","toLowerCase","volBars","revBars","annotations","on","show","hide","push","returnVal","volData","round","currentBatch","j","boxWidth","defaultX","defaultY","vCumulativeDelta","render","propTypes","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport styles from './MainVizComponent.scss'\nimport _ from 'lodash'\nimport { select, selectAll } from 'd3-selection'\nimport { scaleBand,scaleLinear,scaleQuantile,scaleSequential } from 'd3-scale'\nimport { interpolateReds } from 'd3-scale-chromatic'\nimport { axisBottom, axisLeft, axisRight } from 'd3-axis'\nimport { format } from 'd3-format'\nimport { default as tip } from 'd3-tip'\nimport { min, max } from 'd3-array'\nimport { timeMonth } from 'd3-time'\nimport { makeTooltip } from '../../VizHelpers'\nimport {downloadable} from 'd3-downloadable'\nimport { timeFormat, timeParse} from 'd3-time-format'\nimport * as moment from 'moment'\n\n\n\nclass MainVizComponent extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\tthis.createChart = this.createChart.bind(this)\n\t\tthis.state = {\n\t\t\theight: 4000\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tconsole.log(this.props);\n\n\t\tthis.setState({\n\t\t\theight: this.props.timeline \n\t\t\t\t? this.setHeightFromDateExtant(this.props.minDate,this.props.maxDate)\n\t\t\t\t: this.setHeight(this.props.data.length),\n      months: this.props.timeline ? this.props.maxDate.diff(this.props.minDate,'months') : 0\n    })\n\t\tthis.createChart()\n\t}\n\t\n\tcomponentDidUpdate() {\n\t\tthis.createChart()\n\t}\n\t\n\tcomponentWillReceiveProps(nextProps) {\n\t\tif (nextProps.data !== this.props.data || nextProps.timeline !== this.props.timeline) {\n\n\t\t\tthis.setState({\n\t\t\t\theight: nextProps.timeline \n\t\t\t\t\t? this.setHeightFromDateExtant(nextProps.minDate,nextProps.maxDate)\n          : this.setHeight(nextProps.data.length),\n        months: nextProps.timeline ? nextProps.maxDate.diff(nextProps.minDate,'months') : 0\n      })\n      \n\t\t}\n\t}\n\t\n\tsetHeightFromDateExtant = (minDate,maxDate) => this.setHeight(maxDate.diff(minDate,'months'));\n\tsetHeight = (length) => length * 180 + 500;\n\n\tcreateChart() {\n\t\tlet data = this.props.data ? this.props.data : [];\n\t// let timeline = this.props.timeline;\n\t\tlet {revAsCircles, timeline} = this.props;\n\t\tvar margin = {top: 150, right: 5, bottom: 5, left: this.props.width/3 },\n\t\twidth = this.props.width - margin.left - margin.right,\n\t\theight = this.state.height - margin.top - margin.bottom,\n\t\tnode = select(this.node);\n\n\t\tconsole.log(data);\n\t\tconsole.log(revAsCircles);\n\n\t\tdata = _.sortBy(data,\"Date_of_sale\")\n\t// const barHeight = 5;\n\t\tdata.forEach(d => {\n\t\t\td.yRevBottom = 0;\n\t\t\td.yRevTop = 0;\n\t\t})\n  \n    // var durationFormat = format(\".1f\");\n    var numFormat = format(',.2f');\n\n    var yTimeLine = scaleLinear()\n      .range([height, 0]);\n      \n    var yIndex = scaleLinear()\n      .range([height, 0]);\n\n\t\tvar config = {\n      xOffset: 0,\n      yOffset: 0,\n      // width: 150,\n      width: width/8,\n      height: height,\n      labelPositioning: {\n      alpha: 0.5,\n      spacing: 18\n      },\n      leftTitle: \"Lifting\",\n      rightTitle1: \"Buyer\",\n      rightTitle2: \"& Destination\",\n      leftSubTitle: \"Date of Sale\",\n      rightSubTitle: \"Payment Due Date\",\n      labelGroupOffset: 5,\n      labelKeyOffset: 50,\n        radius: 6,\n        subTitleYShift: 20,\n      // Reduce this to turn on detail-on-hover version\n        unfocusOpacity: 0.3,\n        revWidthMultiple: 3.5,\n      priceWidthMultiple: 1.5,\n      timelineWidthMultiple: 0.6\n\t\t}\n\t\t\n\t\tvar smallConfig = {\n\t\t\tmaxwidth: width/15 > 20 ? width/15 : 20,\n\t\t\theight: 10,\n\t\t\t// color: '#c59800',\n\t\t\tcolor: '#ecb600',\n\t\t\thighlightColor: '#CE1126',\n\t\t\tborder: '#eee',\n      volWidth: 2.5,\n      revBoxesPerCol: 10,\n\t\t\tmaxRevWidth: 400,\n\t\t\tvolTitle: \"Volume (barrels)\",\n\t\t\tpriceTitle1: \"Price\",\n\t\t\tpriceTitle2: \"(US$)\",\n\t\t\trevTitle1: \"Revenue\",\n\t\t\trevTitle2: \"(US$)\",\n\t\t}\n\n\t\tlet tooltip = tip()\n\t\t\t.attr('class', 'd3-tip')\n\t\t\t.offset([0, 20])\n\t\t\t.direction(d => revAsCircles ? 'e':'se')\n\t\t\t.html((d) => {\n\t\t\t\treturn makeTooltip(\n\t\t\t\t\td.year,\n\t\t\t\t\t[\n\t\t\t\t\t\t{label:\"Lifting\", value:d.Lifting},\n\t\t\t\t\t\t{label:\"Date of Sale\", value:d.Date_of_sale.format(\"D MMM YYYY\")},\n\t\t\t\t\t\t{label:\"Payment Receipt Date\", value:d.Payment_receipt_date.format(\"D MMM YYYY\")},\n\t\t\t\t\t\t{label:\"Price\", value:\"US$ \"+numFormat(d.Price)+\" per barrel\"},\n\t\t\t\t\t\t{label:\"Volume\", value:numFormat(d.Volume)+\" barrels\"},\n\t\t\t\t\t\t{label:\"Revenue\", value:\"US$ \"+numFormat(d.Revenue)},\n\t\t\t\t\t\t{label:\"Buyer\", value:d.Buyer},\n\t\t\t\t\t\t{label:\"Destination\", value:d.Destination}\n\t\t\t\t\t]\n\t\t\t\t)\n\t\t\t})\n\n\t\tnode.selectAll(\"g\").remove();\n\n\t\tvar colorScale = scaleSequential(interpolateReds)\n      .domain([0,10])\n\n    var parse = timeParse(\"%s\");\n\n    \n    // gridlines in y axis function\n    function make_y_gridlines(months,minDate,maxDate) {\t\t\n      console.log(minDate,maxDate)\n      console.log(timeMonth.range(minDate, maxDate).map(d => +d));\n      return axisLeft(yTimeLine)\n          .tickValues(timeMonth.range(minDate, maxDate).map(d => +d))\n          // .tickValues([1420041600000,1500000000000,1519833600000])\n    }\n\n\n    // \tvar getColor = function(cpue) {\n    // \t\tif (cpue) {\n    // \t\t\treturn colorScale(cpue);\n    // \t\t} else return \"#ccc\";\n    // }\n    \n    var getY = function(yVal,index) {\n      if (timeline) {\n        return yTimeLine(yVal);\n      } else {\n        return yIndex(index);\n      }\n\t}\n\n\t\t\t \n\t// Calculate y domain for ratios\n\tvar maxDate = moment(moment.max(data.map(d => d.Payment_receipt_date)).toDate());\n\tvar minDate = moment(moment.min(data.map(d => d.Date_of_sale)).toDate());\n\n\t\tyTimeLine.domain([timeMonth.floor(maxDate.add(2, 'months')), timeMonth.floor(minDate.subtract(1, 'months'))]);\n    yIndex.domain([data.length, -1]);\n    \n    \n\n    console.log(yTimeLine.domain());\n    console.log(timeMonth.range(timeMonth.floor(yTimeLine.domain()[0]), timeMonth.ceil(yTimeLine.domain()[1])));\n\n    if (timeline) {\n      // add the Y gridlines\n      node.append(\"g\")\t\t\t\n        .attr(\"class\", \"grid\")\n        .attr(\"transform\",\"translate(0,\" + margin.top + \")\")\n        .call(make_y_gridlines(this.state.months,yTimeLine.domain()[1],yTimeLine.domain()[0])\n            .tickSize(-width*2)\n            .tickFormat(function(d) {\n              return timeFormat(\"%b %Y\")(d);\n            })\n        )\n    }\n\n    node.selectAll('.grid text')\n      .attr(\"dy\", 20)\n      .attr(\"dx\", 10)\n\t\t\n\t\t\t\t\n\t\tvar borderLines = node.append(\"g\")\n\t\t\t\t.attr(\"class\", \"borderLines\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\t\tborderLines.append(\"line\")\n\t\t\t.attr(\"x1\", 0).attr(\"y1\", 0)\n\t\t\t.attr(\"x2\", 0).attr(\"y2\", config.height);\n\t\tborderLines.append(\"line\")\n\t\t\t.attr(\"x1\", config.width*config.timelineWidthMultiple ).attr(\"y1\", 0)\n\t\t\t.attr(\"x2\", config.width*config.timelineWidthMultiple ).attr(\"y2\", config.height);\n\t\t\n\t\tvar slopeGroups = node.append(\"g\")\n\t\t\t.selectAll(\"g\")\n\t\t\t.data(data)\n\t\t\t.enter().append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\t\t\t\t.attr(\"class\", \"slope-group\")\n\t\t\t\t.attr(\"id\", function(d, i) {\n\t\t\t\t\td.id = \"group\" + d.Lifting;\n\t\t\t\t\td.sellDate = d.Date_of_sale.toDate();\n\t\t\t\t\td.paymentDate = d.Payment_receipt_date.toDate();\n\t\t\t\t});\n\t\t\n\t\tvar slopeLines = slopeGroups.append(\"line\")\n\t\t\t.attr(\"class\", \"slope-line\")\n\t\t\t.attr(\"x1\", 0)\n\t\t\t.attr(\"y1\", function(d,i) {\n\t\t\t\treturn getY(d.sellDate,i);\n\t\t\t})\n\t\t\t.attr(\"x2\", config.width*config.timelineWidthMultiple)\n\t\t\t.attr(\"y2\", function(d,i) {\n\t\t\t\treturn getY(d.paymentDate,i);\n\t\t\t});\n\t\t\n\t\tvar leftSlopeCircle = slopeGroups.append(\"circle\")\n\t\t.attr(\"class\", function(d) { return \"circle\";})\n\t\t\t.attr(\"r\", config.radius)\n\t\t\t.attr(\"cy\", function(d,i) { return getY(d.sellDate,i);});\n\t\t\n\t\tvar leftSlopeLabels = slopeGroups.append(\"g\")\n\t\t\t.attr(\"class\", \"slope-label-left\")\n\t\t\t.each(function(d,i) {\n\t\t\t\td.xLeftPosition = -config.labelGroupOffset;\n\t\t\t\td.yLeftPosition = getY(d.sellDate,i);\n\t\t\t});\n\t\t\n\t\tleftSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", d => d.xLeftPosition)\n\t\t\t.attr(\"y\", d => d.yLeftPosition)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", config.subTitleYShift)\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.text(d => (d.Date_of_sale.format(\"D MMM YYYY\")));\n\t\t\n\t\tleftSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure\")\n\t\t\t.attr(\"x\", d => d.xLeftPosition)\n\t\t\t.attr(\"y\", d => d.yLeftPosition)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", 3)\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.text(d => d.Lifting);\n\t\t\n\tvar rightSlopeCircle = slopeGroups.append(\"circle\")\n\t\t.attr(\"class\", function(d) { return \"circle\";})\n\t\t.attr(\"r\", config.radius)\n\t\t\t.attr(\"cx\", config.width*config.timelineWidthMultiple)\n\t\t\t.attr(\"cy\", function(d,i) { return getY(d.paymentDate,i);});\n\t\t\n\t\tvar rightSlopeLabels = slopeGroups.append(\"g\")\n\t\t\t.attr(\"class\", \"slope-label-right\")\n\t\t\t.each(function(d,i) {\n\t\t\t\td.xRightPosition = config.width*config.timelineWidthMultiple + config.labelGroupOffset;\n\t\t\t\td.yRightPosition = getY(d.paymentDate,i);\n\t\t\t});\n\t\t\n\t\trightSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", d => d.xRightPosition)\n\t\t\t.attr(\"y\", d => d.yRightPosition)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", 2*config.subTitleYShift)\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.text(d => (d.Payment_receipt_date.format(\"D MMM YYYY\")));\n\t\t\n\t\trightSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure\")\n\t\t\t.attr(\"x\", d => d.xRightPosition)\n\t\t\t.attr(\"y\", d => d.yRightPosition)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", 3)\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t.text(d => d.Buyer);\n\t\t\n\trightSlopeLabels.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure\")\n\t\t\t.attr(\"x\", d => d.xRightPosition)\n\t\t\t.attr(\"y\", d => d.yRightPosition)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", 3+config.subTitleYShift)\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.text(d => d.Destination);\n\t\t\n\t\tvar titles = node.append(\"g\")\n\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t.attr(\"class\", \"title\");\n\t\t\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.attr(\"x\", margin.left)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(config.leftTitle);\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", margin.left)\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", -margin.top / 4 + config.subTitleYShift)\n\t\t\t.text(config.leftSubTitle);\n\t\t\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"x\", margin.left + config.width*config.timelineWidthMultiple)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t.text(config.rightTitle1);\n\ttitles.append(\"text\")\n\t\t\t.attr(\"x\", margin.left + config.width*config.timelineWidthMultiple)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", -margin.top / 4 + config.subTitleYShift)\n\t\t\t.text(config.rightTitle2);\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"class\", \"label-figure-small\")\n\t\t\t.attr(\"x\", margin.left + config.width*config.timelineWidthMultiple)\n\t\t\t.attr(\"dx\", 10)\n\t\t\t.attr(\"dy\", -margin.top / 4 + 2*config.subTitleYShift)\n\t\t\t.text(config.rightSubTitle);\n\n\n\n\t\tvar priceBars = node.append(\"g\")\n\t\t\t.attr(\"transform\", \"translate(\" + (margin.left + config.width) + \",\" + margin.top + \")\")\n\t\t\t.attr(\"class\", \"price\");\n\n\t\tvar smallX = scaleLinear()\n\t\t\t.range([0, smallConfig.maxwidth])\n\t\t.domain([0,100]); \n\t\t\n\tvar maxRev = max(data.map(d => d.Revenue))\n\tvar circleX = scaleLinear()\n\t\t\t.range([0, config.width])\n\t\t\t.domain([0,Math.sqrt(maxRev)]); \n\n\t\tfunction makeClass(d) {\n\t\t\treturn d.Lifting.split(\" \").join(\"\").toLowerCase();\n\t\t} \n\n\tvar volBars = [];\n\t\tvar revBars = [];\n\t\tvar annotations = [];\n\n\t\tpriceBars.selectAll(\".bar\")\n\t\t.data(data)\n\t.enter().append(\"rect\")\n\t\t.attr(\"class\", function(d) { return \"bar price \" + makeClass(d);})\n\t\t.attr(\"x\", function(d) { return config.width*config.priceWidthMultiple; })\n\t\t.attr(\"width\", function(d) { return smallX(+d.Price) })\n\t\t.attr(\"y\", function(d,i) { return d.yRightPosition - smallConfig.height/2; })\n\t\t.attr(\"fill\", function(d) { return smallConfig.color; })\n\t\t.attr(\"stroke\", function(d) { return smallConfig.border; })\n\t\t\t.attr(\"height\", function(d) { return smallConfig.height; })\n\t\t\t.on('mouseover', function(d) {\n\t\ttooltip.show(d,this);\n\t\tselectAll(\".\"+makeClass(d))\n\t\t\t\t\t.attr(\"fill\", smallConfig.highlightColor);\n\t\t\t\t\t\n\t\t\t\tselectAll(\".annote.\"+ makeClass(d))\n\t\t\t\t\t.attr(\"display\", \"block\")\n\t\t\t})\n\t\t\t.on('mouseout', function(d) {\n\t\ttooltip.hide();\n\t\tselectAll(\".\"+makeClass(d))\n\t\t\t\t\t.attr(\"fill\", smallConfig.color);\n\t\t\t\t\t\n\t\t\t\tselectAll(\".annote.\"+ makeClass(d))\n\t\t\t\t\t.attr(\"display\", \"none\")\n\t\t})\n\n\t\tif (revAsCircles) {\n\t\trevBars.push(node.append(\"g\")\n\t\t\t.attr(\"transform\", \"translate(\" + (margin.left + config.width*config.revWidthMultiple) + \",\" + margin.top + \")\")\n\t\t\t.attr(\"class\", function(d) { return \"rev\";}));\n\t\t\t\n\t\trevBars[0].selectAll(\".bar\")\n\t\t\t.data(data)\n\t\t.enter().append(\"circle\")\n\t\t\t.attr(\"class\", function(d) { return \"bar rev \" + makeClass(d);})\n\t\t\t.attr(\"cx\", function(d) { \n\t\t\treturn config.width;\n\t\t\t})\n\t\t\t.attr(\"r\", function(d) { return circleX(Math.sqrt(+d.Revenue)) })\n\t\t\t.attr(\"cy\", function(d) { \n\n\t\t\tvar returnVal = d.yRightPosition;\n\t\t\t\n\t\t\treturn returnVal; \n\t\t\t})\n\t\t\t.attr(\"fill\", function(d) { return smallConfig.color; })\n\t\t\t.attr(\"stroke\", function(d) { return smallConfig.border; })\n\t\t\t// .attr(\"height\", function(d) { return smallConfig.height; })\n\t\t\t.on('mouseover', function(d) {\n\t\t\ttooltip.show(d,this);\n\t\t\tselectAll(\".\"+makeClass(d))\n\t\t\t\t.attr(\"fill\", smallConfig.highlightColor);\n\t\t\tselectAll(\".annote.\"+ makeClass(d))\n\t\t\t\t.attr(\"display\", \"block\")\n\t\t\t})\n\t\t\t.on('mouseout', function(d) {\n\t\t\ttooltip.hide();\n\t\t\tselectAll(\".\"+makeClass(d))\n\t\t\t\t.attr(\"fill\", smallConfig.color);\n\t\t\tselectAll(\".annote.\"+ makeClass(d))\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t})\n\t\t} \n\t\t\t\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.attr(\"x\", margin.left + config.width*(config.priceWidthMultiple+1))\n\t\t\t.attr(\"dx\", -10)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(smallConfig.priceTitle1);\n\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t.attr(\"x\", margin.left + config.width*(config.priceWidthMultiple+1))\n\t\t.attr(\"dx\", -10)\n\t\t.attr(\"dy\", -margin.top / 4 + config.subTitleYShift)\n\t\t.text(smallConfig.priceTitle2);\n\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.attr(\"x\", 0)\n\t\t\t.attr(\"dx\", 0)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(smallConfig.volTitle);\n\n\t\ttitles.append(\"text\")\n\t\t\t.attr(\"text-anchor\", \"start\")\n\t\t\t.attr(\"x\", margin.left + config.width*config.revWidthMultiple)\n\t\t\t.attr(\"dx\", 0)\n\t\t\t.attr(\"dy\", -margin.top / 4)\n\t\t\t.text(smallConfig.revTitle1);\n\ttitles.append(\"text\")\n\t\t.attr(\"x\", margin.left + config.width*config.revWidthMultiple)\n\t\t.attr(\"dx\", 0)\n\t\t.attr(\"dy\", -margin.top / 4 + config.subTitleYShift)\n\t\t.text(smallConfig.revTitle2);\n\n\t\tvar volData = data.map(function(d) {\n\t\t\treturn _.range(0,Math.round(d.Volume/10000))\n\t\t})\n\n\n\t\t// console.log(volData);\n\n\t\t\n\t\tdata.forEach(function(currentBatch,i) {\n\t\t\tvolBars.push(node.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 10 + \",\" + margin.top + \")\")\n\t\t\t\t.attr(\"class\", function(d) { return \"volume\";}))\n\n\t\t\trevBars.push(node.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + (margin.left + config.width*config.revWidthMultiple) + \",\" + margin.top + \")\")\n\t\t\t\t.attr(\"class\", function(d) { return \"rev\";}));\n\n\t\t\t// console.log(volBars);\n\n\t\t\tvolBars[i].selectAll(\".bar\")\n\t\t\t\t.data(volData[i])\n\t\t\t.enter().append(\"rect\")\n\t\t\t.attr(\"class\", function(d) { return \"bar vol \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", function(d,j) { return smallConfig.volWidth*j; })\n\t\t\t\t.attr(\"width\", function(d) { return smallConfig.volWidth })\n\t\t\t\t.attr(\"y\", function(d,j) { return currentBatch.yLeftPosition - smallConfig.height/2; })\n\t\t\t\t.attr(\"fill\", function(d) { return smallConfig.color; })\n\t\t\t\t.attr(\"stroke\", function(d) { return smallConfig.border; })\n\t\t\t\t.attr(\"height\", function(d) { return smallConfig.height; })\n\t\t\t\t.on('mouseover', function(d) {\n\t\t\t\t\ttooltip.show(currentBatch,this);\n\t\t\t\t\tselectAll(\".\"+makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"fill\", smallConfig.highlightColor);\n\t\t\t\t\t\n\t\t\t\t\tselectAll(\".annote.\"+ makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"display\", \"block\")\n\t\t\t\t})\n\t\t\t\t.on('mouseout', function(d) {\n\t\t\t\t\ttooltip.hide();\n\t\t\t\t\tselectAll(\".\"+makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"fill\", smallConfig.color);\n\t\t\t\t\t\n\t\t\t\t\tselectAll(\".annote.\"+ makeClass(currentBatch))\n\t\t\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t})\n\n\t\tif (!revAsCircles) {\n\t\trevBars[i].selectAll(\".bar\")\n\t\t\t.data(volData[i])\n\t\t.enter().append(\"rect\")\n\t\t\t.attr(\"class\", function(d) { return \"bar rev \" + makeClass(currentBatch);})\n\t\t\t.attr(\"x\", function(d,j) { \n\t\t\tvar boxWidth = smallX(+currentBatch.Price)\n\t\t\t// var boxesPerRow = Math.floor(smallConfig.maxRevWidth/boxWidth);\n\t\t\tvar index = Math.floor(j / smallConfig.revBoxesPerCol);\n\t\t\treturn index*boxWidth;\n\t\t\t\n\n\t\t\t})\n\t\t\t.attr(\"width\", function(d) { return smallX(+currentBatch.Price) })\n\t\t\t.attr(\"y\", function(d,j) { \n\t\t\t// var boxWidth = smallX(+currentBatch.Price)\n\t\t\t// var boxesPerRow = Math.floor(smallConfig.maxRevWidth/boxWidth);\n\t\t\t// var row = Math.floor(j/boxesPerRow);\n\n\t\t\t// data[i].yRevBottom = data[i].yRevBottom > returnVal + smallConfig.height \n\t\t\t// \t? data[i].yRevBottom\n\t\t\t// \t: returnVal + smallConfig.height;\n\t\t\t\n\t\t\tvar index = j % smallConfig.revBoxesPerCol;\n\t\t\tvar returnVal = currentBatch.yRightPosition - smallConfig.height/2 + (smallConfig.height*index);\n\t\t\t\n\t\t\tdata[i].yRevBottom = data[i].yRevBottom > returnVal + smallConfig.height \n\t\t\t\t? data[i].yRevBottom\n\t\t\t\t: returnVal + smallConfig.height;\n\t\t\t\n\t\t\treturn returnVal; \n\t\t\t})\n\t\t\t.attr(\"fill\", function(d) { return smallConfig.color; })\n\t\t\t.attr(\"stroke\", function(d) { return smallConfig.border; })\n\t\t\t.attr(\"height\", function(d) { return smallConfig.height; })\n\t\t\t.on('mouseover', function(d) {\n\t\t\ttooltip.show(currentBatch,this);\n\t\t\tselectAll(\".\"+makeClass(currentBatch))\n\t\t\t\t.attr(\"fill\", smallConfig.highlightColor);\n\t\t\tselectAll(\".annote.\"+ makeClass(currentBatch))\n\t\t\t\t.attr(\"display\", \"block\")\n\t\t\t})\n\t\t\t.on('mouseout', function(d) {\n\t\t\ttooltip.hide();\n\t\t\tselectAll(\".\"+makeClass(currentBatch))\n\t\t\t\t.attr(\"fill\", smallConfig.color);\n\t\t\tselectAll(\".annote.\"+ makeClass(currentBatch))\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t})\n\t\t}\n\t\t\t\n\n\t\t\t// Volume Annotation\n\t\t\tnode.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t\t.append(\"text\")\n\t\t\t\t.attr(\"text-anchor\", \"left\")\n\t\t\t\t.attr(\"class\", function(d) { return \"annote vol \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", 10)\n\t\t\t\t.attr(\"dx\", 0)\n\t\t\t\t.attr(\"y\", currentBatch.yLeftPosition - 10)\n\t\t\t\t.attr(\"fill\", smallConfig.color)\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t.text(numFormat(currentBatch.Volume)+\" barrels\")\n\n\t\t\t// Price Annotation\n\t\t\tnode.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t\t.append(\"text\")\n\t\t\t\t.attr(\"text-anchor\", \"middle\")\n\t\t\t\t.attr(\"class\", function(d) { return \"annote price \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", margin.left + config.width*(config.priceWidthMultiple+1.25))\n\t\t\t\t.attr(\"dx\", 0)\n\t\t\t\t.attr(\"y\", currentBatch.yRightPosition)\n\t\t\t\t.attr(\"dy\", -10)\n\t\t\t\t.attr(\"fill\", smallConfig.color)\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t.text(\"US$ \"+numFormat(currentBatch.Price)+\" per barrel\")\n\n\t\t\t// Revenue Annotation\n\t\t\tnode.append(\"g\")\n\t\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + margin.top + \")\")\n\t\t\t\t.append(\"text\")\n\t\t\t\t.attr(\"text-anchor\", \"left\")\n\t\t\t\t.attr(\"class\", function(d) { return \"annote rev \" + makeClass(currentBatch);})\n\t\t\t\t.attr(\"x\", function() {\n\t\t\tvar defaultX = margin.left + config.width*(config.revWidthMultiple+.5);\n\t\t\treturn revAsCircles ? defaultX - config.width: defaultX;\n\t\t})\n\t\t\t\t.attr(\"dx\", 0)\n\t\t\t\t// .attr(\"y\", currentBatch.yRightPosition - 10)\n\t\t\t\t.attr(\"y\", function(d) { \n\t\t\tdata[i].yRevTop = currentBatch.yRightPosition - 30;\n\t\t\tvar defaultY = currentBatch.yRightPosition-10;\n\t\t\treturn revAsCircles ? defaultY - config.width : defaultY;\n\t\t\t\t})\n\t\t\t\t.attr(\"fill\", smallConfig.color)\n\t\t\t\t.attr(\"display\", \"none\")\n\t\t\t\t.text(\"US$ \"+numFormat(currentBatch.Revenue) + \" in revenue \") \n\t\t\t\t\t// + numFormat(data[i].yRevTop) + \" \" + numFormat(data[i].yRevBottom) )\n\t\t\t\n\t\t})\n\n\t\tconsole.log(data);\n\n\t\t// Adjust Rev Blocks so they don't overlap\n\t\t// Start from the bottom and keep pushing all the ones at the top up a bit untill\n\t\t// they no longer overlap\n\tvar vCumulativeDelta = 0;\n\n\t\tfor (var j = data.length-1; j > 0; j--) {\n\t\t\tfor (var i = data.length-1; i > 0; i--) {\n\t\t\n\t\tvCumulativeDelta =  data[i-1].yRevBottom > data[i].yRevTop\n\t\t\t? (data[i-1].yRevBottom-data[i].yRevTop)\n\t\t\t: 0;\n\n\t\tif (vCumulativeDelta > 0) {\n\t\t\tselectAll(\".rev.\" + makeClass(data[i-1]))\n\t\t\t.attr(\"transform\", \"translate(\" + 0 + \",\" + (-vCumulativeDelta) + \")\")\n\t\t\t\n\t\t\tdata[i-1].yRevBottom -= vCumulativeDelta;\n\t\t\tdata[i-1].yRevTop -= vCumulativeDelta;\n\t\t\tbreak;\n\t\t}\n\t\t\t}\n\t\t}\n\n\t\tnode.call(tooltip);\n\t\tselect('.MainChart')\n\t\t\t.call(downloadable());\n\n\t}\n\t\n\t\n\trender() {\n\t\t// let data = this.props.data ? this.props.data : [];\n\n\t\treturn (\n\t\t\t<div className=\"MainVizComponent\">\n\t\t\t\t<svg className=\"MainChart\" ref={node => this.node = node}\n\t\t\t\twidth={this.props.width} height={this.state.height}>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nMainVizComponent.propTypes = {}\n\nMainVizComponent.defaultProps = {}\n\nexport default MainVizComponent\n"]},"metadata":{},"sourceType":"module"}