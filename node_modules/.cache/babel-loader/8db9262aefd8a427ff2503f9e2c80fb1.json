{"ast":null,"code":"var _jsxFileName = \"/Users/yan/Coding/flattenthecurve/src/App.js\";\nimport React, { Component } from 'react';\nimport logo from \"./logo.svg\";\nimport './App.scss';\nimport 'react-widgets/dist/css/react-widgets.css';\nimport _ from 'lodash';\nimport { loadAllData } from './DataLoading';\nimport MainVizComponent from './components/MainVizComponent/MainVizComponent';\nimport { Helmet } from \"react-helmet\";\nimport Switch from \"react-switch\";\nimport { Combobox } from 'react-widgets';\nimport { scaleQuantize, nice } from 'd3-scale';\nimport { extent } from 'd3-array';\nimport * as moment from 'moment';\nimport SimComponent from './components/SimComponent/SimComponent';\nimport { makePerson, getAllNeighbors, newWorld, getNextStateOfWorld } from './Simulate';\n\nclass App extends Component {\n  constructor() {\n    super();\n\n    this.getDateExtent = data => data.length ? extent([...data.map(d => d.Date_of_sale), ...data.map(d => d.Payment_receipt_date)]) : [moment(), moment()];\n\n    this.makeAFilterCombo = filter => React.createElement(\"div\", {\n      className: \"uiWidgetContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"Filter by \", filter, \":\", React.createElement(Combobox, {\n      data: this.state[filter + 'Options'],\n      defaultValue: \"All\",\n      onChange: value => this.handleAllFilters({\n        filter: filter,\n        filterVal: value\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }));\n\n    this.state = { ...this.props,\n      dimensions: {\n        width: window.innerWidth,\n        height: window.innerHeight\n      },\n      currentFilters: [],\n      data: [],\n      timeline: true,\n      revAsCircles: false\n    };\n    this.handleTimeLineChange = this.handleTimeLineChange.bind(this);\n    this.handleFilterYearChange = this.handleFilterYearChange.bind(this);\n    this.handleBuyerChange = this.handleBuyerChange.bind(this);\n    this.handleRevAsCirclesChange = this.handleRevAsCirclesChange.bind(this);\n    this.updateDimensions = this.updateDimensions.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"resize\", this.updateDimensions);\n    this.getData();\n    console.log('mounted');\n  }\n\n  updateDimensions() {\n    this.setState({\n      dimensions: {\n        height: window.innerHeight,\n        width: window.innerWidth\n      }\n    });\n  }\n\n  handleTimeLineChange(checked) {\n    this.setState({\n      timeline: checked\n    });\n  }\n\n  handleRevAsCirclesChange(checked) {\n    this.setState({\n      revAsCircles: checked\n    });\n  }\n\n  handleFilterYearChange(year, originalData) {\n    const filteredData = year === \"All\" ? originalData : originalData.filter(d => d.Date_of_sale.year() === +year);\n    return filteredData;\n  }\n\n  handleBuyerChange(buyer, originalData) {\n    const filteredData = buyer === \"All\" ? originalData : originalData.filter(d => d.Buyer === buyer);\n    return filteredData;\n  }\n\n  handleDestinationChange(destination, originalData) {\n    const filteredData = destination === \"All\" ? originalData : originalData.filter(d => d.Destination === destination);\n    return filteredData;\n  }\n\n  handlePriceChange(price, originalData) {\n    const filteredData = price === \"All\" ? originalData : originalData.filter(d => d.priceRange === this.state.priceOptions.indexOf(price) - 1);\n    return filteredData;\n  }\n\n  handleAllFilters(newFilters) {\n    let filteredData = [...this.state.data];\n    const replaceOldFilters = this.state.currentFilters.map(fil => newFilters.filter === fil.filter ? {\n      filter: fil.filter,\n      filterVal: newFilters.filterVal\n    } : {\n      filter: fil.filter,\n      filterVal: fil.filterVal\n    });\n    console.log(replaceOldFilters);\n    const currentFilters = replaceOldFilters.concat(replaceOldFilters.map(fil => fil.filter).includes(newFilters.filter) ? [] : [newFilters]);\n    console.log(filteredData);\n    console.log(currentFilters);\n\n    for (let i = 0; i < currentFilters.length; i++) {\n      switch (currentFilters[i].filter) {\n        case 'year':\n          filteredData = this.handleFilterYearChange(currentFilters[i].filterVal, filteredData);\n          break;\n\n        case 'buyer':\n          filteredData = this.handleBuyerChange(currentFilters[i].filterVal, filteredData);\n          break;\n\n        case 'destination':\n          filteredData = this.handleDestinationChange(currentFilters[i].filterVal, filteredData);\n          break;\n\n        case 'price':\n          filteredData = this.handlePriceChange(currentFilters[i].filterVal, filteredData);\n          break;\n\n        default:\n          break;\n      }\n    }\n\n    const [minDate, maxDate] = this.getDateExtent(filteredData); // console.log(filteredData);\n    // console.log(currentFilters);\n\n    this.setState({\n      filteredData\n    });\n    this.setState({\n      currentFilters\n    });\n    this.setState({\n      minDate\n    });\n    this.setState({\n      maxDate\n    });\n  }\n\n  getData() {\n    loadAllData().then(data => {\n      // set initial data\n      const pricesList = data.map(row => row.Price);\n      const quantizePrices = scaleQuantize().domain(extent(pricesList)) // pass only the extreme values to a scaleQuantize’s domain\n      .range([...Array(4).keys()]);\n      const quantizePricesNice = quantizePrices.copy().nice();\n      const thresholds = quantizePricesNice.thresholds();\n      const priceRanges = thresholds.map((t, i) => i > 0 ? \"$\" + thresholds[i - 1] + \" to $\" + t : \"$0 to $\" + t);\n      priceRanges.push(\">$\" + thresholds[thresholds.length - 1]);\n      priceRanges.unshift(\"All\");\n      console.log(priceRanges);\n      var trimmedData = data.map(row => {\n        var trimmedRow = {};\n        Object.keys(row).forEach(key => trimmedRow[key] = typeof row[key] === 'string' ? row[key].trim() : row[key]);\n        trimmedRow['priceRange'] = quantizePricesNice(row['Price']);\n        return trimmedRow;\n      });\n      console.log(trimmedData);\n      const [minDate, maxDate] = this.getDateExtent(trimmedData);\n      var years = [\"All\", ..._.uniq(trimmedData.map(d => d.Date_of_sale.year()))];\n      var buyers = [\"All\", ..._.uniq(trimmedData.map(d => d.Buyer))];\n      var destinations = [\"All\", ..._.uniq(trimmedData.map(d => d.Destination))];\n      this.setState({\n        data: trimmedData,\n        filteredData: data,\n        yearOptions: years,\n        buyerOptions: buyers,\n        destinationOptions: destinations,\n        priceOptions: priceRanges,\n        maxDate: maxDate,\n        minDate: minDate\n      });\n    });\n  }\n\n  render() {\n    const isLoading = !!_.isEmpty(this.state.data) ? true : false;\n    const jane = makePerson({\n      initName: \"Jane\"\n    });\n    const jacob = makePerson({\n      initName: \"Jacob\"\n    });\n    console.log(jane.calcInfected({\n      0: [{\n        infected: true\n      }]\n    }, 1));\n    console.log(jacob.calcInfected({\n      0: [{\n        infected: true\n      }, {\n        infected: true\n      }],\n      1: [{\n        infected: true\n      }, {\n        infected: true\n      }]\n    }, 1));\n    const neighborAddresses = getAllNeighbors(5);\n    const world = newWorld(5);\n    console.log(getNextStateOfWorld(world, neighborAddresses));\n    return !!isLoading ? null : React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, React.createElement(\"header\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"application\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, React.createElement(Helmet, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, React.createElement(\"meta\", {\n      charSet: \"utf-8\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }), React.createElement(\"meta\", {\n      name: \"viewport\",\n      content: \"width=1100,initial-scale=0.3,shrink-to-fit=yes\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"uiWidgetContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, \"Timeline View\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228\n      },\n      __self: this\n    }))), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"vizContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, React.createElement(SimComponent, {\n      width: 700,\n      height: 700,\n      numPersons: 1024,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/yan/Coding/flattenthecurve/src/App.js"],"names":["React","Component","_","loadAllData","MainVizComponent","Helmet","Switch","Combobox","scaleQuantize","nice","extent","moment","SimComponent","makePerson","getAllNeighbors","newWorld","getNextStateOfWorld","App","constructor","getDateExtent","data","length","map","d","Date_of_sale","Payment_receipt_date","makeAFilterCombo","filter","state","value","handleAllFilters","filterVal","props","dimensions","width","window","innerWidth","height","innerHeight","currentFilters","timeline","revAsCircles","handleTimeLineChange","bind","handleFilterYearChange","handleBuyerChange","handleRevAsCirclesChange","updateDimensions","componentDidMount","addEventListener","getData","console","log","setState","checked","year","originalData","filteredData","buyer","Buyer","handleDestinationChange","destination","Destination","handlePriceChange","price","priceRange","priceOptions","indexOf","newFilters","replaceOldFilters","fil","concat","includes","i","minDate","maxDate","then","pricesList","row","Price","quantizePrices","domain","range","Array","keys","quantizePricesNice","copy","thresholds","priceRanges","t","push","unshift","trimmedData","trimmedRow","Object","forEach","key","trim","years","uniq","buyers","destinations","yearOptions","buyerOptions","destinationOptions","render","isLoading","isEmpty","jane","initName","jacob","calcInfected","infected","neighborAddresses","world"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport logo from './logo.svg';\nimport './App.scss';\nimport 'react-widgets/dist/css/react-widgets.css';\nimport _ from 'lodash'\nimport { loadAllData } from './DataLoading';\nimport MainVizComponent from './components/MainVizComponent/MainVizComponent';\nimport {Helmet} from \"react-helmet\";\nimport Switch from \"react-switch\";\nimport { Combobox } from 'react-widgets';\nimport { scaleQuantize, nice } from 'd3-scale';\nimport { extent } from 'd3-array';\nimport * as moment from 'moment';\nimport SimComponent from './components/SimComponent/SimComponent';\nimport {makePerson,getAllNeighbors,newWorld,getNextStateOfWorld} from './Simulate';\n\n\nclass App extends Component {\n\n  constructor() {\n    super()\n    this.state = {\n      ...this.props,\n      dimensions: {\n        width: window.innerWidth,\n        height: window.innerHeight\n      },\n      currentFilters: [],\n      data: [],\n      timeline: true,\n      revAsCircles: false\n    };\n    this.handleTimeLineChange = this.handleTimeLineChange.bind(this)\n    this.handleFilterYearChange = this.handleFilterYearChange.bind(this)\n    this.handleBuyerChange = this.handleBuyerChange.bind(this)\n    this.handleRevAsCirclesChange = this.handleRevAsCirclesChange.bind(this)\n    this.updateDimensions = this.updateDimensions.bind(this)\n  }\n\n  \n\n  componentDidMount() {\n    window.addEventListener(\"resize\", this.updateDimensions);\n    this.getData();\n    console.log('mounted')\n  }\n\n  updateDimensions() {\n    this.setState({\n      dimensions: {\n\t\t\t\theight: window.innerHeight, \n\t\t\t\twidth: window.innerWidth\n\t\t\t}\n    });\n  }\n\n  handleTimeLineChange(checked) {\n    this.setState({ timeline: checked });\n  }\n\n  handleRevAsCirclesChange(checked) {\n    this.setState({ revAsCircles: checked });\n  }\n  \n  handleFilterYearChange(year,originalData) {\n    const filteredData = year === \"All\"\n      ? originalData\n      : originalData.filter(d => d.Date_of_sale.year() === +year)\n    return filteredData\n  }\n\n  handleBuyerChange(buyer,originalData) {\n    const filteredData = buyer === \"All\"\n      ? originalData\n      : originalData.filter(d => d.Buyer === buyer)\n    return filteredData;\n  }\n\n  handleDestinationChange(destination,originalData) {\n    const filteredData = destination === \"All\"\n      ? originalData\n      : originalData.filter(d => d.Destination === destination)\n    return filteredData;\n  }\n\n  handlePriceChange(price,originalData) {\n    const filteredData = price === \"All\"\n      ? originalData\n      : originalData.filter(d => d.priceRange === this.state.priceOptions.indexOf(price) - 1)\n    return filteredData;\n  }\n\n  handleAllFilters(newFilters) {\n    let filteredData = [...this.state.data];\n    const replaceOldFilters = this.state.currentFilters.map(fil => \n      newFilters.filter === fil.filter \n      ? {filter: fil.filter,filterVal: newFilters.filterVal} \n      : {filter: fil.filter,filterVal: fil.filterVal} \n    );\n    console.log(replaceOldFilters);\n    const currentFilters = replaceOldFilters.concat(\n      replaceOldFilters.map(fil => fil.filter).includes(newFilters.filter) \n        ? []\n        : [newFilters]\n    );\n    console.log(filteredData);\n    console.log(currentFilters);\n    for (let i = 0; i < currentFilters.length; i++) {\n      switch (currentFilters[i].filter) {\n        case('year'):\n          filteredData = this.handleFilterYearChange(currentFilters[i].filterVal,filteredData);\n          break;\n        case('buyer'):\n          filteredData = this.handleBuyerChange(currentFilters[i].filterVal,filteredData);\n          break;\n        case('destination'):\n          filteredData = this.handleDestinationChange(currentFilters[i].filterVal,filteredData);\n          break;\n        case('price'):\n          filteredData = this.handlePriceChange(currentFilters[i].filterVal,filteredData);\n          break;\n        default: break;\n      }\n    }\n    const [minDate,maxDate] = this.getDateExtent(filteredData);\n\n\n    // console.log(filteredData);\n    // console.log(currentFilters);\n    this.setState({ filteredData });\n    this.setState({ currentFilters });\n    this.setState({ minDate });\n    this.setState({ maxDate });\n  }\n\n  getDateExtent = (data) => data.length ? extent([...data.map(d=>d.Date_of_sale),...data.map(d=>d.Payment_receipt_date)]) : [moment(),moment()];\n\n  getData() {\n    loadAllData()\n      .then(data => {\n        // set initial data\n        const pricesList = data.map(row => row.Price);\n        const quantizePrices = scaleQuantize()\n          .domain(extent(pricesList)) // pass only the extreme values to a scaleQuantize’s domain\n          .range([...Array(4).keys()]);\n        const quantizePricesNice = quantizePrices.copy().nice();\n        \n        const thresholds = quantizePricesNice.thresholds();\n        const priceRanges = thresholds.map((t,i) => i > 0 \n          ? \"$\" + thresholds[i-1] + \" to $\" + t\n          : \"$0 to $\" + t )\n        priceRanges.push(\">$\" + thresholds[thresholds.length-1]);\n        priceRanges.unshift(\"All\");\n        console.log(priceRanges);\n\n        var trimmedData = data.map(row => {\n          var trimmedRow = {};\n          Object.keys(row).forEach(key => trimmedRow[key] = typeof row[key] === 'string' ? row[key].trim(): row[key]);\n          trimmedRow['priceRange'] = quantizePricesNice(row['Price']);\n          return trimmedRow;\n        })\n        console.log(trimmedData);\n        \n        const [minDate,maxDate] = this.getDateExtent(trimmedData);\n\n        \n        var years = [\"All\", ..._.uniq(trimmedData.map(d => d.Date_of_sale.year()))];\n        var buyers = [\"All\", ..._.uniq(trimmedData.map(d => d.Buyer))];\n        var destinations = [\"All\", ..._.uniq(trimmedData.map(d => d.Destination))];\n        this.setState({ \n          data: trimmedData, \n          filteredData: data,\n          yearOptions: years,\n          buyerOptions: buyers,\n          destinationOptions: destinations,\n          priceOptions: priceRanges,\n          maxDate: maxDate,\n          minDate: minDate\n        });\n      })\n  }\n\n  makeAFilterCombo = (filter) => <div className=\"uiWidgetContainer\">\n    Filter by {filter}:\n    <Combobox\n      data={this.state[filter+'Options']}\n      defaultValue={\"All\"}\n      onChange={value => this.handleAllFilters({filter:filter,filterVal:value}) }\n    />\n  </div>\n\n  render() {\n    const isLoading = !!(_.isEmpty(this.state.data)) ? true : false;\n    const jane = makePerson({initName:\"Jane\"});\n    const jacob = makePerson({initName:\"Jacob\"});\n    console.log(jane.calcInfected({0:[{infected:true}]},1));\n    console.log(jacob.calcInfected({0:[{infected:true},{infected:true}],1:[{infected:true},{infected:true}]},1));\n    const neighborAddresses = getAllNeighbors(5);\n    const world = newWorld(5);\n    console.log(getNextStateOfWorld(world,neighborAddresses));\n\n    return (\n\n      \n      !!isLoading\n      ? null\n      : <div className=\"App\">\n\n        <header>\n        <div className=\"application\">\n            <Helmet>\n              <meta charSet=\"utf-8\" />\n              <meta name=\"viewport\" content=\"width=1100,initial-scale=0.3,shrink-to-fit=yes\" />\n            </Helmet>\n        </div>\n        </header>\n\n        {/* <div className=\"uiWidgetContainer\">\n          <label>\n            <span>Revenue as Circles</span>\n            <br/>\n            <Switch onChange={this.handleRevAsCirclesChange} checked={this.state.revAsCircles} />\n          </label>\n        </div> */}\n        <div className=\"uiWidgetContainer\">\n          <label>\n            <span>Timeline View</span>\n            <br/>\n            {/* <Switch onChange={this.handleTimeLineChange} checked={this.state.timeline} /> */}\n          </label>\n        </div>\n        {/* {this.makeAFilterCombo('buyer')}\n        {this.makeAFilterCombo('destination')}\n        {this.makeAFilterCombo('year')}\n        {this.makeAFilterCombo('price')} */}\n        <br/>\n        <br/>\n        \n        \n        \n\n        <div className=\"vizContainer\">\n        <SimComponent width={700} height={700} numPersons={1024}></SimComponent>\n\n        </div>\n        \n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}